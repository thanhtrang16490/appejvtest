---
import '../styles/global.css'
import LanguageSwitcher from '../components/LanguageSwitcher.astro'
import { getLangFromUrl, type Language } from '../i18n/languages'
import { getLocalizedPath } from '../i18n/url-utils'

interface Props {
  title: string
  description?: string
  keywords?: string[]
  ogImage?: string
  canonical?: string
  lang?: Language
}

const currentLang = Astro.props.lang || getLangFromUrl(Astro.url)

const { 
  title, 
  description = currentLang === 'en' 
    ? 'APPE JV specializes in manufacturing and supplying high-quality animal feed for pigs, poultry, and aquaculture. Established in 2008, applying advanced technology, exporting to Southeast Asia and Europe.'
    : currentLang === 'cn'
    ? 'APPE JVä¸“ä¸šç”Ÿäº§å’Œä¾›åº”é«˜è´¨é‡çš„çŒªã€å®¶ç¦½å’Œæ°´äº§é¥²æ–™ã€‚æˆç«‹äº2008å¹´ï¼Œåº”ç”¨å…ˆè¿›æŠ€æœ¯ï¼Œå‡ºå£åˆ°ä¸œå—äºšå’Œæ¬§æ´²ã€‚'
    : 'APPE JV chuyÃªn sáº£n xuáº¥t vÃ  cung cáº¥p thá»©c Äƒn chÄƒn nuÃ´i cháº¥t lÆ°á»£ng cao cho heo, gia cáº§m vÃ  thá»§y sáº£n. ThÃ nh láº­p tá»« 2008, á»©ng dá»¥ng cÃ´ng nghá»‡ tiÃªn tiáº¿n, xuáº¥t kháº©u sang ÄÃ´ng Nam Ã vÃ  ChÃ¢u Ã‚u.',
  keywords = [
    'thá»©c Äƒn chÄƒn nuÃ´i',
    'thá»©c Äƒn heo',
    'thá»©c Äƒn gia cáº§m',
    'thá»©c Äƒn thá»§y sáº£n',
    'APPE JV',
    'APPE Viá»‡t Nam',
    'pig feed',
    'poultry feed',
    'fish feed',
    'chÄƒn nuÃ´i',
    'thá»§y sáº£n',
    'HÃ  Nam',
    'thá»©c Äƒn cháº¥t lÆ°á»£ng cao'
  ],
  ogImage = '/og-image.png',
  canonical
} = Astro.props

const APP_URL = 'https://app.appejv.app'
const SITE_URL = Astro.url.origin
const currentUrl = canonical || Astro.url.pathname
const fullUrl = `${SITE_URL}${currentUrl}`
const ogImageUrl = `${SITE_URL}${ogImage}`

// Structured Data - Organization
const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "APPE JV Viá»‡t Nam",
  "alternateName": "CÃ´ng ty Cá»• pháº§n APPE JV Viá»‡t Nam",
  "url": SITE_URL,
  "logo": `${SITE_URL}/appejv-logo.png`,
  "description": description,
  "foundingDate": "2008",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Km 50 Quá»‘c lá»™ 1A, XÃ£ TiÃªn TÃ¢n",
    "addressLocality": "Phá»§ LÃ½",
    "addressRegion": "HÃ  Nam",
    "addressCountry": "VN"
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": "+84-3513-595-202",
    "contactType": "customer service",
    "areaServed": "VN",
    "availableLanguage": ["vi", "en"]
  },
  "sameAs": [
    "https://www.facebook.com/appevn",
    "https://appe.com.vn"
  ]
}

// Structured Data - Website
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "APPE JV Viá»‡t Nam",
  "url": SITE_URL,
  "description": description,
  "publisher": {
    "@type": "Organization",
    "name": "APPE JV Viá»‡t Nam",
    "logo": {
      "@type": "ImageObject",
      "url": `${SITE_URL}/appejv-logo.png`
    }
  }
}
---

<!DOCTYPE html>
<html lang={currentLang}>
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RGN1EGREY6"></script>
    <script is:inline>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RGN1EGREY6');
    </script>
    
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords.join(', ')} />
    <meta name="author" content="APPE JV Viá»‡t Nam" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={fullUrl} />
    
    <!-- Sitemap -->
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={fullUrl} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImageUrl} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:site_name" content="APPE JV Viá»‡t Nam" />
    <meta property="og:locale" content={currentLang === 'en' ? 'en_US' : currentLang === 'cn' ? 'zh_CN' : 'vi_VN'} />
    
    <!-- Alternate Language Links -->
    {currentLang === 'vi' && canonical && (
      <>
        <link rel="alternate" hreflang="en" href={`${SITE_URL}/en${canonical}`} />
        <link rel="alternate" hreflang="zh" href={`${SITE_URL}/cn${canonical}`} />
      </>
    )}
    {currentLang === 'en' && canonical && (
      <>
        <link rel="alternate" hreflang="vi" href={`${SITE_URL}${canonical.replace('/en', '')}`} />
        <link rel="alternate" hreflang="zh" href={`${SITE_URL}/cn${canonical.replace('/en', '')}`} />
      </>
    )}
    {currentLang === 'cn' && canonical && (
      <>
        <link rel="alternate" hreflang="vi" href={`${SITE_URL}${canonical.replace('/cn', '')}`} />
        <link rel="alternate" hreflang="en" href={`${SITE_URL}/en${canonical.replace('/cn', '')}`} />
      </>
    )}
    <link rel="alternate" hreflang="x-default" href={`${SITE_URL}${canonical?.replace('/en', '').replace('/cn', '') || '/'}`} />
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={fullUrl} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageUrl} />
    <meta name="twitter:creator" content="@appejv" />
    <meta name="twitter:site" content="@appejv" />
    
    <!-- Zalo Open Graph -->
    <meta property="zalo:title" content={title} />
    <meta property="zalo:description" content={description} />
    <meta property="zalo:image" content={ogImageUrl} />
    <meta property="zalo:url" content={fullUrl} />
    <meta property="zalo:app_id" content="YOUR_ZALO_APP_ID" />
    
    <!-- Additional SEO Meta Tags -->
    <meta name="geo.region" content="VN-63" />
    <meta name="geo.placename" content="HÃ  Nam" />
    <meta name="geo.position" content="20.5385;105.9189" />
    <meta name="ICBM" content="20.5385, 105.9189" />
    <meta name="language" content="Vietnamese" />
    <meta name="revisit-after" content="7 days" />
    <meta name="rating" content="general" />
    <meta name="distribution" content="global" />
    <meta name="coverage" content="Worldwide" />
    <meta name="target" content="all" />
    <meta name="audience" content="all" />
    <meta name="classification" content="Business" />
    <meta name="category" content="Agriculture, Animal Feed, Aquaculture" />
    <meta name="subject" content="Thá»©c Äƒn chÄƒn nuÃ´i vÃ  thá»§y sáº£n" />
    <meta name="copyright" content="APPE JV Viá»‡t Nam" />
    <meta name="owner" content="APPE JV Viá»‡t Nam" />
    <meta name="reply-to" content="info@appe.com.vn" />
    <meta name="url" content={fullUrl} />
    <meta name="identifier-URL" content={fullUrl} />
    <meta name="directory" content="submission" />
    <meta name="pagename" content={title} />
    <meta name="page-topic" content="Animal Feed, Livestock Nutrition, Aquaculture Feed" />
    <meta name="page-type" content="Business Website" />
    
    <!-- Facebook Domain Verification -->
    <meta name="facebook-domain-verification" content="YOUR_FB_DOMAIN_VERIFICATION" />
    
    <!-- Google Site Verification -->
    <meta name="google-site-verification" content="YOUR_GOOGLE_VERIFICATION_CODE" />
    
    <!-- Bing Webmaster -->
    <meta name="msvalidate.01" content="YOUR_BING_VERIFICATION_CODE" />
    
    <!-- Yandex Verification -->
    <meta name="yandex-verification" content="YOUR_YANDEX_VERIFICATION_CODE" />
    
    <!-- Theme & Mobile -->
    <meta name="theme-color" content="#175ead" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="APPE JV" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="APPE JV" />
    <meta name="msapplication-TileColor" content="#175ead" />
    <meta name="msapplication-TileImage" content="/appejv-logo.png" />
    
    <!-- Format Detection -->
    <meta name="format-detection" content="telephone=yes" />
    <meta name="format-detection" content="email=yes" />
    <meta name="format-detection" content="address=yes" />
    
    <title>{title}</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/png" href="/appejv-logo.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/appejv-logo.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/appejv-logo.png" />
    <link rel="apple-touch-icon" href="/appejv-logo.png" sizes="180x180" />
    <link rel="apple-touch-icon-precomposed" href="/appejv-logo.png" />
    <link rel="mask-icon" href="/appejv-logo.png" color="#175ead" />
    <link rel="icon" type="image/png" sizes="192x192" href="/appejv-logo.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/appejv-logo.png" />
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://www.google-analytics.com" />
    <link rel="preconnect" href="https://www.googletagmanager.com" />
    <link rel="dns-prefetch" href="https://connect.facebook.net" />
    <link rel="dns-prefetch" href="https://sp.zalo.me" />
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script is:inline>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX', {
        page_path: window.location.pathname,
        send_page_view: true
      });
    </script>
    
    <!-- Facebook Pixel -->
    <script is:inline>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', 'YOUR_FACEBOOK_PIXEL_ID');
      fbq('track', 'PageView');
    </script>
    <noscript>
      <img height="1" width="1" style="display:none"
        src="https://www.facebook.com/tr?id=YOUR_FACEBOOK_PIXEL_ID&ev=PageView&noscript=1"
      />
    </noscript>
    
    <!-- Zalo Tracking -->
    <script is:inline>
      (function(z,a,l,o){
        z[o]=z[o]||function(){(z[o].q=z[o].q||[]).push(arguments)};
        var d=a.createElement(l),s=a.getElementsByTagName(l)[0];
        d.async=1;d.src='https://sp.zalo.me/plugins/sdk.js';
        s.parentNode.insertBefore(d,s);
      })(window,document,'script','ZaloSocialSDK');
    </script>
    
    <!-- Hotjar Tracking (Optional) -->
    <script is:inline>
      (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:YOUR_HOTJAR_ID,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
      })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
  </head>
  <body class="bg-white min-h-screen">
    <!-- Header - Apple Style -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white/70 backdrop-blur-2xl border-b border-gray-200/80 transition-all duration-300">
      <div class="max-w-[980px] mx-auto px-4 sm:px-6">
        <div class="flex items-center justify-between h-11">
          <!-- Logo -->
          <a href="/" class="flex items-center gap-2 group -ml-2">
            <img 
              src="/appejv-logo.png" 
              alt="APPE JV Logo" 
              class="w-7 h-7 object-contain opacity-90 group-hover:opacity-100 transition-opacity duration-200"
            />
            <span class="text-[17px] font-semibold text-[#175ead] tracking-tight leading-none">
              APPE JV
            </span>
          </a>

          <!-- Desktop Navigation -->
          <nav class="hidden md:flex items-center gap-8">
            <a href={currentLang === 'en' ? '/en' : currentLang === 'cn' ? '/cn' : '/'} class="text-[12px] font-normal text-gray-800 hover:text-gray-900 transition-colors duration-200 tracking-tight">
              {currentLang === 'en' ? 'Home' : currentLang === 'cn' ? 'é¦–é¡µ' : 'Trang chá»§'}
            </a>
            <a href={currentLang === 'en' ? '/en/about' : currentLang === 'cn' ? '/cn/about' : '/gioi-thieu'} class="text-[12px] font-normal text-gray-800 hover:text-gray-900 transition-colors duration-200 tracking-tight">
              {currentLang === 'en' ? 'About' : currentLang === 'cn' ? 'å…³äºæˆ‘ä»¬' : 'Giá»›i thiá»‡u'}
            </a>
            <a href={currentLang === 'en' ? '/en/products' : currentLang === 'cn' ? '/cn/products' : '/san-pham'} class="text-[12px] font-normal text-gray-800 hover:text-gray-900 transition-colors duration-200 tracking-tight">
              {currentLang === 'en' ? 'Products' : currentLang === 'cn' ? 'äº§å“' : 'Sáº£n pháº©m'}
            </a>
            <a href={currentLang === 'en' ? '/en/news' : currentLang === 'cn' ? '/cn/news' : '/tin-tuc'} class="text-[12px] font-normal text-gray-800 hover:text-gray-900 transition-colors duration-200 tracking-tight">
              {currentLang === 'en' ? 'News' : currentLang === 'cn' ? 'æ–°é—»' : 'Tin tá»©c'}
            </a>
            <a href={currentLang === 'en' ? '/en/contact' : currentLang === 'cn' ? '/cn/contact' : '/lien-he'} class="text-[12px] font-normal text-gray-800 hover:text-gray-900 transition-colors duration-200 tracking-tight">
              {currentLang === 'en' ? 'Contact' : currentLang === 'cn' ? 'è”ç³»æˆ‘ä»¬' : 'LiÃªn há»‡'}
            </a>
            <LanguageSwitcher />
            <a href={`${APP_URL}/auth/login`} class="text-[12px] font-normal text-blue-600 hover:text-blue-700 transition-colors duration-200 tracking-tight">
              {currentLang === 'en' ? 'Login' : currentLang === 'cn' ? 'ç™»å½•' : 'ÄÄƒng nháº­p'}
            </a>
          </nav>

          <!-- Mobile Menu Button -->
          <button 
            id="mobile-menu-button"
            class="md:hidden p-1.5 text-gray-700 hover:text-gray-900 transition-colors -mr-1.5"
            aria-label="Toggle menu"
          >
            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
        </div>
      </div>
    </header>

    <!-- Mobile Menu Overlay -->
    <div 
      id="mobile-menu-overlay"
      class="fixed inset-0 bg-black/30 backdrop-blur-sm z-40 md:hidden opacity-0 pointer-events-none transition-opacity duration-300"
    ></div>

    <!-- Mobile Menu - Dropdown from top -->
    <div 
      id="mobile-menu"
      class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-2xl z-50 transform -translate-y-full transition-transform duration-400 ease-out md:hidden border-b border-gray-200"
    >
      <div class="max-w-[980px] mx-auto px-4 sm:px-6">
        <!-- Mobile Menu Header -->
        <div class="flex items-center justify-between h-11 border-b border-gray-200/50">
          <div class="flex items-center gap-2">
            <img 
              src="/appejv-logo.png" 
              alt="APPE JV Logo" 
              class="w-7 h-7 object-contain opacity-90"
            />
            <span class="text-[17px] font-semibold text-[#175ead] tracking-tight">APPE JV</span>
          </div>
          <button
            id="mobile-menu-close"
            class="p-1.5 text-gray-700 hover:text-gray-900 transition-colors -mr-1.5"
            aria-label="Close menu"
          >
            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        <!-- Mobile Menu Content -->
        <nav class="py-4">
          <div class="space-y-0.5">
            <a href={currentLang === 'en' ? '/en' : currentLang === 'cn' ? '/cn' : '/'} class="mobile-menu-link block px-3 py-2.5 text-[14px] text-gray-900 hover:bg-gray-100/60 rounded-lg transition-colors font-normal">
              {currentLang === 'en' ? 'Home' : currentLang === 'cn' ? 'é¦–é¡µ' : 'Trang chá»§'}
            </a>
            <a href={currentLang === 'en' ? '/en/about' : currentLang === 'cn' ? '/cn/about' : '/gioi-thieu'} class="mobile-menu-link block px-3 py-2.5 text-[14px] text-gray-900 hover:bg-gray-100/60 rounded-lg transition-colors font-normal">
              {currentLang === 'en' ? 'About' : currentLang === 'cn' ? 'å…³äºæˆ‘ä»¬' : 'Giá»›i thiá»‡u'}
            </a>
            <a href={currentLang === 'en' ? '/en/products' : currentLang === 'cn' ? '/cn/products' : '/san-pham'} class="mobile-menu-link block px-3 py-2.5 text-[14px] text-gray-900 hover:bg-gray-100/60 rounded-lg transition-colors font-normal">
              {currentLang === 'en' ? 'Products' : currentLang === 'cn' ? 'äº§å“' : 'Sáº£n pháº©m'}
            </a>
            <a href={currentLang === 'en' ? '/en/news' : currentLang === 'cn' ? '/cn/news' : '/tin-tuc'} class="mobile-menu-link block px-3 py-2.5 text-[14px] text-gray-900 hover:bg-gray-100/60 rounded-lg transition-colors font-normal">
              {currentLang === 'en' ? 'News' : currentLang === 'cn' ? 'æ–°é—»' : 'Tin tá»©c'}
            </a>
            <a href={currentLang === 'en' ? '/en/contact' : currentLang === 'cn' ? '/cn/contact' : '/lien-he'} class="mobile-menu-link block px-3 py-2.5 text-[14px] text-gray-900 hover:bg-gray-100/60 rounded-lg transition-colors font-normal">
              {currentLang === 'en' ? 'Contact' : currentLang === 'cn' ? 'è”ç³»æˆ‘ä»¬' : 'LiÃªn há»‡'}
            </a>
            
            <!-- Language Switcher in Mobile -->
            <div class="px-3 py-2.5">
              <div class="flex items-center gap-2 text-[14px] text-gray-600">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
                </svg>
                <span class="font-medium">{currentLang === 'en' ? 'Language' : currentLang === 'cn' ? 'è¯­è¨€' : 'NgÃ´n ngá»¯'}</span>
              </div>
              <div class="mt-2 space-y-1">
                <a href={getLocalizedPath(Astro.url.pathname, 'vi')} class="block px-3 py-2 text-[13px] rounded-lg transition-colors" class:list={[currentLang === 'vi' ? 'bg-gray-100 text-gray-900 font-semibold' : 'text-gray-600 hover:bg-gray-50']}>
                  ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t
                </a>
                <a href={getLocalizedPath(Astro.url.pathname, 'en')} class="block px-3 py-2 text-[13px] rounded-lg transition-colors" class:list={[currentLang === 'en' ? 'bg-gray-100 text-gray-900 font-semibold' : 'text-gray-600 hover:bg-gray-50']}>
                  ğŸ‡¬ğŸ‡§ English
                </a>
                <a href={getLocalizedPath(Astro.url.pathname, 'cn')} class="block px-3 py-2 text-[13px] rounded-lg transition-colors" class:list={[currentLang === 'cn' ? 'bg-gray-100 text-gray-900 font-semibold' : 'text-gray-600 hover:bg-gray-50']}>
                  ğŸ‡¨ğŸ‡³ ä¸­æ–‡
                </a>
              </div>
            </div>
            
            <a href={`${APP_URL}/auth/login`} class="mobile-menu-link block px-3 py-2.5 text-[14px] text-blue-600 hover:bg-gray-100/60 rounded-lg transition-colors font-normal">
              {currentLang === 'en' ? 'Login' : currentLang === 'cn' ? 'ç™»å½•' : 'ÄÄƒng nháº­p'}
            </a>
          </div>
        </nav>
      </div>
    </div>

    <script>
      // Mobile menu functionality
      const menuButton = document.getElementById('mobile-menu-button');
      const menuClose = document.getElementById('mobile-menu-close');
      const menu = document.getElementById('mobile-menu');
      const overlay = document.getElementById('mobile-menu-overlay');
      const menuLinks = document.querySelectorAll('.mobile-menu-link');

      function openMenu() {
        menu?.classList.remove('-translate-y-full');
        overlay?.classList.remove('opacity-0', 'pointer-events-none');
        document.body.style.overflow = 'hidden';
      }

      function closeMenu() {
        menu?.classList.add('-translate-y-full');
        overlay?.classList.add('opacity-0', 'pointer-events-none');
        document.body.style.overflow = '';
      }

      menuButton?.addEventListener('click', openMenu);
      menuClose?.addEventListener('click', closeMenu);
      overlay?.addEventListener('click', closeMenu);
      menuLinks.forEach(link => link.addEventListener('click', closeMenu));

      // Header scroll effect - more subtle
      let lastScroll = 0;
      const header = document.querySelector('header');
      
      window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 50) {
          header?.classList.add('shadow-sm');
          header?.classList.remove('bg-white/70');
          header?.classList.add('bg-white/90');
        } else {
          header?.classList.remove('shadow-sm');
          header?.classList.remove('bg-white/90');
          header?.classList.add('bg-white/70');
        }
        
        lastScroll = currentScroll;
      });
    </script>

    <!-- Main Content -->
    <main>
      <slot />
    </main>

    <!-- Footer - Apple Style -->
    <footer class="bg-[#f5f5f7] text-gray-900 border-t border-gray-200">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Main Footer Content -->
        <div class="py-12 md:py-16">
          <!-- Top Section: App Downloads & Company Info -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 mb-12 pb-12 border-b border-gray-300">
            <!-- Left: Mobile Apps -->
            <div>
              <h3 class="text-2xl md:text-3xl font-semibold mb-4 tracking-tight">
                {currentLang === 'en' ? 'Download APPE App' : currentLang === 'cn' ? 'ä¸‹è½½APPEåº”ç”¨' : 'Táº£i á»©ng dá»¥ng APPE'}
              </h3>
              <p class="text-gray-600 mb-6 text-sm md:text-base font-light leading-relaxed max-w-md">
                {currentLang === 'en' 
                  ? 'Manage orders, track deliveries and receive exclusive offers right on your phone'
                  : currentLang === 'cn'
                  ? 'ç®¡ç†è®¢å•ã€è·Ÿè¸ªé…é€å¹¶åœ¨æ‰‹æœºä¸Šè·å¾—ç‹¬å®¶ä¼˜æƒ '
                  : 'Quáº£n lÃ½ Ä‘Æ¡n hÃ ng, theo dÃµi giao hÃ ng vÃ  nháº­n Æ°u Ä‘Ã£i Ä‘á»™c quyá»n ngay trÃªn Ä‘iá»‡n thoáº¡i'
                }
              </p>
              <div class="flex flex-col sm:flex-row gap-3">
                <!-- App Store Badge -->
                <a 
                  href={currentLang === 'en' ? '/en/app' : currentLang === 'cn' ? '/cn/app' : '/ung-dung'}
                  class="inline-flex items-center gap-3 bg-black text-white px-5 py-3 rounded-lg hover:bg-gray-800 transition-all group"
                  aria-label="Download on App Store"
                >
                  <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                  </svg>
                  <div class="text-left">
                    <div class="text-[10px] opacity-90">{currentLang === 'en' ? 'Download on' : currentLang === 'cn' ? 'ä¸‹è½½äº' : 'Táº£i trÃªn'}</div>
                    <div class="text-base font-semibold -mt-0.5">App Store</div>
                  </div>
                </a>
                
                <!-- Google Play Badge -->
                <a 
                  href={currentLang === 'en' ? '/en/app' : currentLang === 'cn' ? '/cn/app' : '/ung-dung'}
                  class="inline-flex items-center gap-3 bg-black text-white px-5 py-3 rounded-lg hover:bg-gray-800 transition-all group"
                  aria-label="Get it on Google Play"
                >
                  <svg class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3,20.5V3.5C3,2.91 3.34,2.39 3.84,2.15L13.69,12L3.84,21.85C3.34,21.6 3,21.09 3,20.5M16.81,15.12L6.05,21.34L14.54,12.85L16.81,15.12M20.16,10.81C20.5,11.08 20.75,11.5 20.75,12C20.75,12.5 20.53,12.9 20.18,13.18L17.89,14.5L15.39,12L17.89,9.5L20.16,10.81M6.05,2.66L16.81,8.88L14.54,11.15L6.05,2.66Z"/>
                  </svg>
                  <div class="text-left">
                    <div class="text-[10px] opacity-90">{currentLang === 'en' ? 'Get it on' : currentLang === 'cn' ? 'è·å–äº' : 'Táº£i trÃªn'}</div>
                    <div class="text-base font-semibold -mt-0.5">Google Play</div>
                  </div>
                </a>
              </div>
            </div>

            <!-- Right: Company Info -->
            <div>
              <div class="flex items-center gap-3 mb-4">
                <img 
                  src="/appejv-logo.png" 
                  alt="APPE JV Logo" 
                  class="w-12 h-12 object-contain"
                />
                <div>
                  <div class="text-2xl font-semibold tracking-tight">APPE JV</div>
                  <div class="text-xs text-gray-500">A Group</div>
                </div>
              </div>
              <p class="text-gray-600 text-sm leading-relaxed mb-4 font-light">
                {currentLang === 'en' 
                  ? 'APPE JV Vietnam Joint Stock Company'
                  : currentLang === 'cn'
                  ? 'APPE JVè¶Šå—è‚¡ä»½å…¬å¸'
                  : 'CÃ´ng ty Cá»• pháº§n APPE JV Viá»‡t Nam'
                }<br />
                {currentLang === 'en'
                  ? 'Professional nutrition solutions for livestock and aquaculture'
                  : currentLang === 'cn'
                  ? 'ç•œç‰§å’Œæ°´äº§å…»æ®–çš„ä¸“ä¸šè¥å…»è§£å†³æ–¹æ¡ˆ'
                  : 'Giáº£i phÃ¡p dinh dÆ°á»¡ng chuyÃªn nghiá»‡p cho chÄƒn nuÃ´i vÃ  thá»§y sáº£n'
                }
              </p>
              <div class="flex gap-2">
                <a href="https://www.facebook.com/appevn" target="_blank" rel="noopener noreferrer" class="w-9 h-9 bg-gray-200 hover:bg-gray-300 rounded-full flex items-center justify-center transition-colors" aria-label="Facebook">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                  </svg>
                </a>
                <a href="#" class="w-9 h-9 bg-gray-200 hover:bg-gray-300 rounded-full flex items-center justify-center transition-colors" aria-label="YouTube">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                  </svg>
                </a>
                <a href="#" class="w-9 h-9 bg-gray-200 hover:bg-gray-300 rounded-full flex items-center justify-center transition-colors" aria-label="LinkedIn">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                  </svg>
                </a>
              </div>
            </div>
          </div>

          <!-- Links Grid -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-8">
            <!-- Products -->
            <div>
              <h4 class="text-xs font-semibold mb-4 tracking-wide uppercase text-gray-500">
                {currentLang === 'en' ? 'Products' : currentLang === 'cn' ? 'äº§å“' : 'Sáº£n pháº©m'}
              </h4>
              <ul class="space-y-2.5">
                <li><a href={currentLang === 'en' ? '/en/products' : currentLang === 'cn' ? '/cn/products' : '/san-pham'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Pig Feed' : currentLang === 'cn' ? 'çŒªé¥²æ–™' : 'Thá»©c Äƒn heo'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/products' : currentLang === 'cn' ? '/cn/products' : '/san-pham'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Poultry Feed' : currentLang === 'cn' ? 'å®¶ç¦½é¥²æ–™' : 'Thá»©c Äƒn gia cáº§m'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/products' : currentLang === 'cn' ? '/cn/products' : '/san-pham'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Fish Feed' : currentLang === 'cn' ? 'æ°´äº§é¥²æ–™' : 'Thá»©c Äƒn thá»§y sáº£n'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/products' : currentLang === 'cn' ? '/cn/products' : '/san-pham'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'View all' : currentLang === 'cn' ? 'æŸ¥çœ‹å…¨éƒ¨' : 'Xem táº¥t cáº£'}
                </a></li>
              </ul>
            </div>

            <!-- Company -->
            <div>
              <h4 class="text-xs font-semibold mb-4 tracking-wide uppercase text-gray-500">
                {currentLang === 'en' ? 'Company' : currentLang === 'cn' ? 'å…¬å¸' : 'CÃ´ng ty'}
              </h4>
              <ul class="space-y-2.5">
                <li><a href={currentLang === 'en' ? '/en/about' : currentLang === 'cn' ? '/cn/about' : '/gioi-thieu'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'About' : currentLang === 'cn' ? 'å…³äºæˆ‘ä»¬' : 'Giá»›i thiá»‡u'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/about' : currentLang === 'cn' ? '/cn/about' : '/gioi-thieu'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Vision' : currentLang === 'cn' ? 'æ„¿æ™¯' : 'Táº§m nhÃ¬n'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/contact' : currentLang === 'cn' ? '/cn/contact' : '/lien-he'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Contact' : currentLang === 'cn' ? 'è”ç³»æˆ‘ä»¬' : 'LiÃªn há»‡'}
                </a></li>
                <li><a href={`${APP_URL}/auth/login`} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Login' : currentLang === 'cn' ? 'ç™»å½•' : 'ÄÄƒng nháº­p'}
                </a></li>
              </ul>
            </div>

            <!-- Support -->
            <div>
              <h4 class="text-xs font-semibold mb-4 tracking-wide uppercase text-gray-500">
                {currentLang === 'en' ? 'Support' : currentLang === 'cn' ? 'æ”¯æŒ' : 'Há»— trá»£'}
              </h4>
              <ul class="space-y-2.5">
                <li><a href={currentLang === 'en' ? '/en/faq' : currentLang === 'cn' ? '/cn/faq' : '/cau-hoi-thuong-gap'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">FAQ</a></li>
                <li><a href={currentLang === 'en' ? '/en/downloads' : currentLang === 'cn' ? '/cn/downloads' : '/tai-lieu'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Downloads' : currentLang === 'cn' ? 'ä¸‹è½½èµ„æ–™' : 'Táº£i tÃ i liá»‡u'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/news' : currentLang === 'cn' ? '/cn/news' : '/tin-tuc'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'News' : currentLang === 'cn' ? 'æ–°é—»' : 'Tin tá»©c'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/contact' : currentLang === 'cn' ? '/cn/contact' : '/lien-he'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Contact' : currentLang === 'cn' ? 'è”ç³»æˆ‘ä»¬' : 'LiÃªn há»‡'}
                </a></li>
              </ul>
            </div>

            <!-- Legal -->
            <div>
              <h4 class="text-xs font-semibold mb-4 tracking-wide uppercase text-gray-500">
                {currentLang === 'en' ? 'Legal' : currentLang === 'cn' ? 'æ³•å¾‹' : 'PhÃ¡p lÃ½'}
              </h4>
              <ul class="space-y-2.5">
                <li><a href={currentLang === 'en' ? '/en/privacy-policy' : currentLang === 'cn' ? '/cn/privacy-policy' : '/chinh-sach-bao-mat'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Privacy Policy' : currentLang === 'cn' ? 'éšç§æ”¿ç­–' : 'ChÃ­nh sÃ¡ch báº£o máº­t'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/terms-of-service' : currentLang === 'cn' ? '/cn/terms-of-service' : '/dieu-khoan-su-dung'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Terms of Service' : currentLang === 'cn' ? 'æœåŠ¡æ¡æ¬¾' : 'Äiá»u khoáº£n sá»­ dá»¥ng'}
                </a></li>
                <li><a href={currentLang === 'en' ? '/en/cookie-policy' : currentLang === 'cn' ? '/cn/cookie-policy' : '/chinh-sach-cookie'} class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                  {currentLang === 'en' ? 'Cookie Policy' : currentLang === 'cn' ? 'Cookieæ”¿ç­–' : 'ChÃ­nh sÃ¡ch cookie'}
                </a></li>
                <li><a href="/sitemap.xml" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">Sitemap</a></li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Footer Bottom -->
        <div class="border-t border-gray-300 py-6">
          <div class="flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-gray-500">
            <p>
              Â© 2026 APPE JV {currentLang === 'en' ? 'Vietnam' : currentLang === 'cn' ? 'è¶Šå—' : 'Viá»‡t Nam'}. {currentLang === 'en' ? 'Established 2008' : currentLang === 'cn' ? 'æˆç«‹äº2008å¹´' : 'ThÃ nh láº­p nÄƒm 2008'}. {currentLang === 'en' ? 'All rights reserved' : currentLang === 'cn' ? 'ç‰ˆæƒæ‰€æœ‰' : 'Táº¥t cáº£ quyá»n Ä‘Æ°á»£c báº£o lÆ°u'}.
            </p>
            <div class="flex items-center gap-4">
              <span>{currentLang === 'en' ? 'Vietnam' : currentLang === 'cn' ? 'è¶Šå—' : 'Viá»‡t Nam'}</span>
              <span>|</span>
              <a href="tel:+84351359520" class="hover:text-gray-900 transition-colors">+84 351 359 520</a>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
